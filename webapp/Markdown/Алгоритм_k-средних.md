На каждой итерации вычисляется центр масс для каждого кластера, полученного на предыдущем шаге, затем объекты снова разбиваются на кластеры в соответствии с тем, какой из новых центров оказался ближе по выбранной метрике.

### **Алгоритм k-means**:
- Получаем на вход выборку объектов и количество заданных кластеров p
- Инициализация центроидов. Случаем образом выбирается p точек и объявляются центрами кластеров. Возможны различные стратегии для уменьшения итераций
- Разбиение на кластеры. В зависимости от задачи выбирается метрика, и для каждого объекта измеряется расстояние для каждого кластера. Меньшее расстояние к какому-то из кластеру определяет принадлежность объекта к нему
- Вычисление новых центроидов. Теперь центроиды не перенимают значения точек, а вычисляются, как центр масс новообразованного кластера, вычисленный через средние значения признаков элементов в кластере
- Шаги 3-4 повторяются до выполнения критерия остановки
- На выходе получаем центроиды и метки объектов выборки

**Критерии остановки:**
- Кластеры перестали изменяться, то есть центроиды стабилизированы
- Превышено заданное число итераций

### [[Модификации алгоритма k-means]]
### Выбор числа кластеров
Выбор числа кластеров для оптимизации работы алгоритма осуществляется с помощью следующих алгоритмов:
- [[Метод локтя]]
- [[Силуэтный метод]]

### **Пример работы алгоритма**
![[k-means1.png|550]]
![[k-means2.png|550]]

