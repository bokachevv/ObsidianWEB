### **Общие действия агломеративной кластеризации**
- На первой итерации каждый объект образует кластер
- На следующих итерациях ближайшие кластеры, расстояние до которых определяется выбранной метрикой, объединяются в один
- Процесс будет выполняться до достижения критерия остановки

Алгоритм чем-то похож на алгоритм кодирования Шенона-Фано, где мы каждый раз объединяем два самых "дешевых" объекта, образуя дерево. Данный алгоритм использует 2 функции расстояния для образования новых кластеров и подсчета расстояния между ними:
- [[Метрики расстояния]]
- [[Функции расстояния между кластерами]]

После образования нового кластера на каждом шаге нужно быстро подсчитывать расстояние от новообразовавшегося кластера $W=U+V$ до любого другого кластера $S$. Для этого используется [[Формула Ланса-Уильямса]] с числовыми параметрами для метода Уорда в оптимальном случае:

$\displaystyle R(W,S)=\alpha_{U}\cdot R(U,S)+\alpha_{V}\cdot(V,S)+\beta\cdot R(U,V)+\gamma\cdot|R(U,S)-R(V,S)|$
### **Алгоритм агломеративной кластеризации**
В дальнейшем использование метода Уорда для подбора кластеров не используется, так как формула Ланса-Уильямся в сочетании с параматрами для метода Уорда позволяет ускорить вычисления. Целиком оптимальный алгоритм агломеративной кластеризации выглядит так:
- Разбиваем все множество данных на единичные кластеры
- На первой итерации вычисляется расстояние между всеми кластерами с помощью [[Функции расстояния между кластерами]]. Мы будем использовать метод Уорда, поэтому он будет отбирать кластеры с минимальным евклидовым расстоянием и минимальной инерцией системы(отклонение точек от центроида). После подсчета оптимальных расстояний два кластера объединяются в один
- На последующих итерациях для новообразованных кластеров используется [[Формула Ланса-Уильямса]] с числовыми параметрами для метода Уорда, так как она автоматизирует обновление расстояний, так как имеет числовые параметры метода Уорда с прошлой итерации, и нам не приходится пересчитывать все расстояния с нуля
- Выполняем третий шаг до выполнелния критерия остановки. Важно помнить, что расстояния между кластерами не уменьшается, то есть соблюдается монотонность. Это нужно для наглядности и предотвращения пересечения кластеров

**Критерии остановки алгомеративной кластеризации:**
- Остается только один кластер
- Образуется заданное число кластеров

![[Ward Hierarchy Clusterization.png]]
